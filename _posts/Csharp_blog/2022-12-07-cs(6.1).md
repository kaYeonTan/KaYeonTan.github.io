---
title:  "Lesson 6 이벤트"
excerpt: "6.1 이벤트의 기본"

categories:
  - csharp
tags:
  - [Csharp, C#]

toc: true
toc_sticky: true
 
date: 2022-12-07
last_modified_at: 2022-12-07
---

#### 6.1 이벤트의 기본   
---
<br>
<br>

##### 움직임이 있는 프로그램을 작성한다  

**사용자가 윈도를 조작했을 때 무언가를 처리하는 프로그램을 작성할 수 있다**

<br>
<br>

##### 이벤트 처리의 구조를 안다  

윈도를 가진 프로그램은 통상 **폼을 클릭했다**는 사용자의 조작을 `이벤트(event)`라는 개념으로 다룬다. 이벤트의 발생처가 되는 컨트롤은 `소스(source)`라고 한다. 즉, *폼을 클릭했다*와 같은 이벤트를 생각할 때는 폼이 소스가 되는 것이다.  

발생한 이벤트는 `이벤트 핸들러(event handler)`라는 메서드에서 처리한다.  

✨ **이벤트 처리** 이벤트 처리는 소스, 이벤트, 이벤트 핸들러에 의해 시행한다.  

<br>
<br>

##### 이벤트 처리를 기술한다  

다음과 같은 코드를 작성해 이벤트를 처리하는 프로그램을 작성할 수 있다.  

1. 이벤트를 처리하는 이벤트 핸들러를 정의한다.  
2. 그 이벤트 핸들러를 델리게이트에 의해 소스(폼)에 등록한다.  

①에서는 이벤트 핸들러에 적당한 이름을 붙여서 정의한다. 예를 들어 **fm_Click()**이라는 이름으로 메서드를 정의한다. 폼을 클릭했을 때 처리 한다는 의미이다.  
이름은 식별자로부터 적당히 선택해도 되지만, 이 이벤트 핸들러에는 **Object와** **EvectArgs**라는 두 종류의 정해진 클래스의 인수를 갖게 해야 한다.  

```cs
public static void fm_Click(object sender, EventArgs e)
{
    lb.Text = "안녕하세요";    
}
```

다음은 ②로서 이벤트 핸들러를 소스에 등록하는 처리를 시행한다. 이 등록은 `델리게이트(delegate)`라는 구조를 사용해서 시행한다. EventHandler()라는 이름의 델리게이트를 작성해서 등록을 시행하는 것이다.  

```cs
this.Click += new EventHandler(fm_Click);
```

델리게이트를 작성할 때 인수로 설계한 이벤트 핸들러의 이름을 전달한다. 이 델리게이트를 소스의 폼의 Click 이벤트에 += 연산자를 사용해서 추가하는 형식으로 등록한다.  

이때 ①, ②의 코드를 기술해 두면 실제로 *폼을 클릭했다*는 이벤트가 발생했을 때, **이벤트 핸들러가 소스로부터 호출되고 이벤트가 처리된다**는 구조로 실행된다.  

다음은 이벤트 처리 코드이다.  

```cs
using System;
using System.Windows.Forms;

class Sample1 : Form
{
    Label lb;

    public static void Main()
    {
        Application.Run(new Sample1());
    }

    public Sample1()
    {
        this.Text = "샘플";
        this.Width = 250; this.Height = 200;
        lb = new Label();
        lb.Text = "어서 오세요";
        lb.Parent = this;
        this.Click += new EventHandler(fm_Click);
    }
    public void fm_Click(object sender, EventArgs e)
    {
        lb.Text = "안녕하세요";    
    }
}
```

![image](https://user-images.githubusercontent.com/106606698/206066398-8c1b767f-066b-4f51-aa89-c89cc056b455.png)
![image](https://user-images.githubusercontent.com/106606698/206066421-2a041f0d-3c80-45d9-b353-61e91836515d.png)

창을 클릭하면 텍스트가 바뀌는 것을 확인 할 수 있다.  

✨ **이벤트 핸들러의 등록** ① 이벤트 핸들러를 설계하고, ② 이벤트 핸들러를 델리게이터에 의해 등록해 두면 이벤트가 발생했을 때 이벤트 핸들러에서 이벤트 처리가 이루어진다.  

<br>
<br>

##### 델리게이트의 구조를 안다  

이 이벤트 처리의 구조는 클래스 라이브러리 내에서 다음과 같이 기술되어있다.  
이벤트는 소스로 정의되어 발생시킬 수 있다. 델리게이트에 의해 이 이벤트를 처리해야 하는 이벤트 핸들러의 인수 목록이 선언된다.  

>델리게이트의 선언

```cs
//델리게이트 선언
public void delegate 델리게이트명(이벤트핸들러의 인수목록); 

class 소스 클래스명;
{
    //이벤트 선언
    public event 델리게이트명 이벤트명;
    public 형 이벤트가발생하는 메서드명()
    {
        //소스가 이벤트를 발생시킨다.
        이벤트명(this, 인수목록);
        . . .
    }
}
```

이 중, 정해져있는 **소스명**, **이벤트명**, **델리게이트명**, **이벤트 핸들러의 인수**에 따라서 이벤트 핸들러를 설계, 등록함으로써 이벤트 처리를 할 수 있게 된다.  

이벤트 처리에 있어서는 소스인 폼과 이벤트를 처리하는 이벤트 핸들러가 다른 코드로 되어있는 것이 특징이다. 소스에서 발생한 이벤트의 처리를 이벤트 핸들러에 **의뢰**헤서 처리하는 것이다. 이 구조는 다양한 이벤트 중. 필요한 이벤트만을 등록한 이벤트 핸들러에만 의뢰해 처리하기 때문에 효율적인 처리가 이루어진다.  

어떤 클래스가 다른 부분에 처리를 의뢰하는 구조를 일반적으로 **델리게이트(위임, delegate)**라고 하기도 한다. C#의 델리게이트는 이 의뢰 구조를 등록하는 역할을 갖고 있다.  

✨ **델리게이트** 소스에 의뢰되어 다른 부분이 처리하는 것을 델리게이트라고 한다. C#의 델리게이트는 이 의뢰의 구조를 등록한다.  